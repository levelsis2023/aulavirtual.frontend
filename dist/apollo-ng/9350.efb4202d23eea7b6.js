"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[9350],{9350:($,c,l)=>{l.r(c),l.d(c,{CalendarAppModule:()=>H});var p=l(6814),s=l(6223),g=l(8007),M=l(5932),y=l(6111),A=l(3023),e=l(8926),h=l(6031),b=l(375),m=l(2495),v=l(3530),w=l(5219),u=l(6218),f=l(6760),_=l(3714),C=l(3965);function D(a,r){if(1&a&&(e.TgZ(0,"span",7),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Oqu("display"===t.view?t.changedEvent.title:"new"===t.view?"Nuevo Evento":"Editar Evento")}}const x=function(){return[]},T=function(){return{hour:"2-digit",minute:"2-digit"}};function S(a,r){if(1&a&&(e.TgZ(0,"div")(1,"div",9)(2,"div",10)(3,"div",11),e._uU(4,"Inicio"),e.qZA(),e.TgZ(5,"p",12),e._UZ(6,"i",13),e.TgZ(7,"span"),e._uU(8),e.qZA()()(),e.TgZ(9,"div",10)(10,"div",11),e._uU(11,"Fin"),e.qZA(),e.TgZ(12,"p",12),e._UZ(13,"i",13),e.TgZ(14,"span"),e._uU(15),e.qZA()()()(),e.TgZ(16,"div",9)(17,"div",10)(18,"div",11),e._uU(19,"Docente"),e.qZA(),e.TgZ(20,"p",14),e._UZ(21,"i",15),e.TgZ(22,"span"),e._uU(23),e.qZA()()(),e.TgZ(24,"div",10)(25,"div",11),e._uU(26,"Aula"),e.qZA(),e.TgZ(27,"p",16)(28,"span"),e._uU(29),e.qZA(),e.TgZ(30,"small"),e._UZ(31,"i",17),e._uU(32),e.qZA()()()()()),2&a){const t=e.oxw(2);e.xp6(8),e.Oqu(t.changedEvent.start.toLocaleTimeString(e.DdM(5,x),e.DdM(6,T))),e.xp6(7),e.Oqu(t.changedEvent.end.toLocaleTimeString(e.DdM(7,x),e.DdM(8,T))),e.xp6(8),e.Oqu(t.changedEvent.docente),e.xp6(6),e.Oqu(t.changedEvent.aulaName),e.xp6(3),e.hij(" ",t.changedEvent.aulaUbicacion,"")}}function U(a,r){if(1&a&&(e.TgZ(0,"div",39),e._UZ(1,"div",40),e.TgZ(2,"div"),e._uU(3),e.qZA()()),2&a){const t=e.oxw(4);e.xp6(1),e.Udp("background-color",t.changedEvent.tag.color),e.xp6(2),e.Oqu(t.changedEvent.tag.name)}}function O(a,r){if(1&a&&e.YNc(0,U,4,3,"div",38),2&a){const t=e.oxw(3);e.Q6J("ngIf",t.changedEvent.tag)}}function k(a,r){if(1&a&&(e.TgZ(0,"div",39),e._UZ(1,"div",40),e.TgZ(2,"div"),e._uU(3),e.qZA()()),2&a){const t=r.$implicit;e.xp6(1),e.Udp("background-color",t.color),e.xp6(2),e.Oqu(t.name)}}function J(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"div",18)(2,"div",19)(3,"label",20),e._uU(4,"T\xedtulo"),e.qZA(),e.TgZ(5,"span",21),e._UZ(6,"i",22),e.TgZ(7,"input",23),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.title=o)}),e.qZA()()(),e.TgZ(8,"div",19)(9,"label",24),e._uU(10,"Ubicaci\xf3n"),e.qZA(),e.TgZ(11,"span",21),e._UZ(12,"i",25),e.TgZ(13,"input",26),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.location=o)}),e.qZA()()(),e.TgZ(14,"div",27)(15,"label",28),e._uU(16,"Descripci\xf3n del evento"),e.qZA(),e.TgZ(17,"textarea",29),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.description=o)}),e.qZA()(),e.TgZ(18,"div",19)(19,"label",30),e._uU(20,"Fecha de Inicio"),e.qZA(),e.TgZ(21,"p-calendar",31),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.start=o)}),e.qZA()(),e.TgZ(22,"div",19)(23,"label",32),e._uU(24,"Fecha Fin"),e.qZA(),e.TgZ(25,"p-calendar",33),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.end=o)}),e.qZA()(),e.TgZ(26,"div",27)(27,"label",34),e._uU(28,"Color"),e.qZA(),e.TgZ(29,"p-dropdown",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changedEvent.tag=o)}),e.YNc(30,O,1,1,"ng-template",36),e.YNc(31,k,4,3,"ng-template",37),e.qZA()()()()}if(2&a){const t=e.oxw(2),n=e.MAs(3);e.xp6(7),e.Q6J("ngModel",t.changedEvent.title),e.xp6(6),e.Q6J("ngModel",t.changedEvent.location),e.xp6(4),e.Q6J("rows",5)("ngModel",t.changedEvent.description),e.xp6(4),e.Q6J("appendTo",n)("maxDate",t.changedEvent.end)("showTime",!0)("required",!0)("ngModel",t.changedEvent.start),e.xp6(4),e.Q6J("appendTo",n)("minDate",t.changedEvent.start)("showTime",!0)("required",!0)("ngModel",t.changedEvent.end),e.xp6(4),e.Q6J("appendTo",n)("options",t.tags)("ngModel",t.changedEvent.tag)}}function N(a,r){if(1&a&&(e.YNc(0,S,33,9,"div",8),e.YNc(1,J,32,17,"div",8)),2&a){const t=e.oxw();e.Q6J("ngIf","display"===t.view),e.xp6(1),e.Q6J("ngIf","display"!==t.view)}}function I(a,r){}const q=function(){return{width:"36rem"}},F=function(){return{"960px":"75vw","640px":"90vw"}};let P=(()=>{class a{constructor(t,n){this.eventService=t,this.helpersService=n,this.events=[],this.today="",this.calendarOptions={initialView:"dayGridMonth"},this.showDialog=!1,this.clickedEvent=null,this.dateClicked=!1,this.edit=!1,this.tags=[],this.view="",this.courseStyles={}}ngOnInit(){this.today=(new Date).toISOString().split("T")[0];const t={alumno_id:this.helpersService.getAlumnoId()??1,domain_id:this.helpersService.getDominioId()};this.eventService.getEventsAlumno(t).subscribe(n=>{this.events=this.getEventsAlumno(n),this.calendarOptions={...this.calendarOptions,events:this.events},this.tags=this.events.map(o=>{if(!this.tags.includes(o.tag))return o.tag})}),this.calendarOptions={plugins:[M.Z,A.Z,y.ZP],height:720,initialDate:this.today,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,eventClick:n=>this.onEventClick(n),select:n=>this.onDateSelect(n),events:this.events}}getEventsAlumno(t){const n=t.map(o=>{const i=JSON.parse(o.horarios);return this.generateEventDetails(i,o.nombre)});return console.log(n.flat()),n.flat()}generateEventDetails(t,n){const o=[],i=this.getCourseStyles(n);return t.forEach(d=>{const Z=new Date(`${d.fecha_inicio}T${d.hora_inicio}`),K=new Date(`${d.fecha_fin}T${d.hora_fin}`),E=d.day_id;o.push({day_name:this.getDayName(E),date:this.addDays(Z,E).toISOString().split("T")[0],start:Z,end:K,tag:{color:i.backgroundColor,name:n},title:n,borderColor:i.borderColor,backgroundColor:i.backgroundColor,textColor:i.textColor,extendedProps:{docente:d.docente_name,aulaUbicacion:d.aula_ubication,aulaName:d.aula_name}})}),o}getCourseStyles(t){if(this.courseStyles[t])return this.courseStyles[t];const n=this.generateStyles();return this.courseStyles[t]=n,n}getDayName(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t%7]}addDays(t,n){const o=new Date(t);return o.setDate(o.getDate()+n),o}generateStyles(){const n=["#f9e79f","#a3e4d7","#abebc6","#f5b041","#ec7063","#cacfd2"],o=["#000000"],i=n[Math.floor(Math.random()*n.length)];return{backgroundColor:i,borderColor:i,textColor:o[Math.floor(Math.random()*o.length)]}}onEventClick(t){this.clickedEvent=t.event;let n=t.event.toPlainObject({collapseExtendedProps:!0,collapseColor:!0});this.view="display",this.showDialog=!0,console.log(n),this.changedEvent={...n,...this.clickedEvent},this.changedEvent.start=this.clickedEvent.start,this.changedEvent.end=this.clickedEvent.end?this.clickedEvent.end:this.clickedEvent.start}onDateSelect(t){}handleSave(){this.validate()&&(this.showDialog=!1,this.clickedEvent={...this.changedEvent,backgroundColor:this.changedEvent.tag.color,borderColor:this.changedEvent.tag.color,textColor:"#212121"},this.events=this.clickedEvent.hasOwnProperty("id")?this.events.map(t=>t.id.toString()===this.clickedEvent.id.toString()?t=this.clickedEvent:t):[...this.events,{...this.clickedEvent,id:Math.floor(1e4*Math.random())}],this.calendarOptions={...this.calendarOptions,events:this.events},this.clickedEvent=null)}onEditClick(){this.view="edit"}delete(){this.events=this.events.filter(t=>t.id.toString()!==this.clickedEvent.id.toString()),this.calendarOptions={...this.calendarOptions,events:this.events},this.showDialog=!1}validate(){let{start:t,end:n}=this.changedEvent;return t&&n}static#e=this.\u0275fac=function(n){return new(n||a)(e.Y36(h.P),e.Y36(b.$))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["ng-component"]],decls:7,vars:9,consts:[[1,"card"],[3,"options"],[3,"visible","breakpoints","modal","closable","visibleChange","onHide"],["dd",""],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"text-900","font-semibold","text-xl"],[4,"ngIf"],[1,"grid"],[1,"col-6"],[1,"text-900","font-semibold","mb-2"],[1,"flex","align-items-center","m-0"],[1,"pi","pi-fw","pi-clock","text-700","mr-2"],[1,"flex","align","-items-center","m-0"],[1,"pi","pi-fw","pi-user","text-700","mr-2"],[1,"flex","flex-column","m-0"],[1,"pi","pi-fw","pi-map-marker","text-700","mr-2"],[1,"grid","p-fluid","formgrid"],[1,"col-12","md:col-6","field"],["for","title",1,"text-900","font-semibold"],[1,"p-input-icon-left"],[1,"pi","pi-pencil"],["id","title","type","text","pInputText","","placeholder","T\xedtulo",3,"ngModel","ngModelChange"],["for","location",1,"text-900","font-semibold"],[1,"pi","pi-map-marker"],["id","location","type","text","pInputText","","placeholder","Ubicaci\xf3n",3,"ngModel","ngModelChange"],[1,"col-12","field"],["for","description",1,"text-900","font-semibold"],["id","description","type","text","pInputTextarea","",2,"resize","none",3,"rows","ngModel","ngModelChange"],["for","start",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","start",3,"appendTo","maxDate","showTime","required","ngModel","ngModelChange"],["for","end",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","end",3,"appendTo","minDate","showTime","required","ngModel","ngModelChange"],["for","company-color",1,"text-900","font-semibold"],["inputId","company-color","optionLabel","name",3,"appendTo","options","ngModel","ngModelChange"],["pTemplate","selectedItem"],["pTemplate","item"],["class","flex align-items-center",4,"ngIf"],[1,"flex","align-items-center"],[1,"flex-shrink-0","w-1rem","h-1rem","mr-2","border-circle"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"full-calendar",1),e.TgZ(2,"p-dialog",2,3),e.NdJ("visibleChange",function(d){return o.showDialog=d})("onHide",function(){return o.view=""}),e.YNc(4,D,2,1,"ng-template",4),e.YNc(5,N,2,2,"ng-template",5),e.YNc(6,I,0,0,"ng-template",6),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("options",o.calendarOptions),e.xp6(1),e.Akn(e.DdM(7,q)),e.Q6J("visible",o.showDialog)("breakpoints",e.DdM(8,F))("modal",!0)("closable",!0))},dependencies:[p.O5,s.Fj,s.JJ,s.Q7,s.On,m.w,v.V,w.jx,u.g,f.f,_.o,C.Lt],styles:["@media screen and (max-width: 768px){[_nghost-%COMP%]     .fc .fc-toolbar{justify-content:center}[_nghost-%COMP%]     .fc-header-toolbar{display:flex;align-items:center;gap:1rem;justify-content:center;text-align:center;flex-wrap:wrap}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(2){width:100%;order:0}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(1){order:1}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(3){order:2}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(3) .fc-button-group .fc-today-button{margin-left:2rem}}"]})}return a})(),Q=(()=>{class a{static#e=this.\u0275fac=function(n){return new(n||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({imports:[g.Bz.forChild([{path:"",component:P}]),g.Bz]})}return a})();var G=l(707),Y=l(4480),j=l(4104);let H=(()=>{class a{static#e=this.\u0275fac=function(n){return new(n||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({providers:[h.P],imports:[p.ez,s.u5,Q,m.z,v.S,u.A,G.hJ,f._8,_.j,C.kW,j.EV,Y.T]})}return a})()}}]);