"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[6761],{6761:(A,b,n)=>{n.r(b),n.d(b,{ForoAlumnosRoutingModule:()=>X});var r=n(8007),f=n(1230),p=n(6223),x=n(6760),h=n(9552),u=n(6022),m=n(707),a=n(7902),l=n(3714),v=n(6218),_=n(6804),M=n(4480),T=n(4055),O=n(3965),Z=n(6651),R=n(4104),D=n(1494),E=n(3722),P=n(3259),S=n(3904),C=n(6860),F=n(3530),J=n(5118),I=n(3999),e=n(8926),U=n(7649),H=n(375),w=n(5219),y=n(6814);function L(o,g){1&o&&(e.TgZ(0,"span",6),e._uU(1,"Foros"),e.qZA())}function z(o,g){if(1&o&&(e.TgZ(0,"li",31)(1,"div",32)(2,"span",33),e._uU(3),e.qZA(),e.TgZ(4,"span",34),e._uU(5),e.ALo(6,"date"),e.qZA()(),e._UZ(7,"p",35),e.qZA()),2&o){const t=g.$implicit;e.xp6(3),e.Oqu(t.alumno),e.xp6(2),e.Oqu(e.xi3(6,3,t.fecha,"dd/MM/yyyy HH:mm")),e.xp6(2),e.Q6J("innerHTML",t.respuesta,e.oJD)}}function N(o,g){if(1&o&&(e.TgZ(0,"ul",29),e.YNc(1,z,8,6,"li",30),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.subrespuestas)}}function B(o,g){if(1&o){const t=e.EpF();e.TgZ(0,"li",22)(1,"div",23)(2,"span",24),e._uU(3),e.qZA(),e.TgZ(4,"span",25),e._uU(5),e.ALo(6,"date"),e.qZA()(),e._UZ(7,"p",26),e.TgZ(8,"button",27),e.NdJ("click",function(){const c=e.CHM(t).$implicit,d=e.oxw().$implicit,k=e.oxw(2);return e.KtG(k.selectForo(d,c))}),e.qZA(),e.YNc(9,N,2,1,"ul",28),e.qZA()}if(2&o){const t=g.$implicit,s=e.oxw().$implicit,i=e.oxw(2);e.xp6(3),e.Oqu(t.alumno),e.xp6(2),e.Oqu(e.xi3(6,5,t.fecha,"dd/MM/yyyy HH:mm")),e.xp6(2),e.Q6J("innerHTML",t.respuesta,e.oJD),e.xp6(1),e.Q6J("disabled",i.isExpired(s.fecha_fin)),e.xp6(1),e.Q6J("ngIf",t.subrespuestas&&t.subrespuestas.length>0)}}function $(o,g){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"h3",13),e._uU(2),e.qZA(),e._UZ(3,"p",14),e.TgZ(4,"div",15),e._UZ(5,"i",16),e.TgZ(6,"span",17),e._uU(7),e.ALo(8,"date"),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"span",18),e._uU(11),e.qZA()(),e.TgZ(12,"ul",19),e.YNc(13,B,10,8,"li",20),e.qZA(),e.TgZ(14,"button",21),e.NdJ("click",function(){const c=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.selectForo(c))}),e.qZA()()}if(2&o){const t=g.$implicit,s=e.oxw(2);e.xp6(2),e.Oqu(t.foro_name),e.xp6(1),e.Q6J("innerHTML",t.foro_pregunta,e.oJD),e.xp6(4),e.AsE("Inicio: ",e.xi3(8,8,t.fecha_inicio,"dd/MM/yyyy")," | Fin: ",e.xi3(9,11,t.fecha_fin,"dd/MM/yyyy"),""),e.xp6(3),e.Q6J("ngClass",s.getDaysRemainingClass(t.fecha_fin)),e.xp6(1),e.hij(" (",s.getDaysRemaining(t.fecha_fin),") "),e.xp6(2),e.Q6J("ngForOf",t.respuestas),e.xp6(1),e.Q6J("disabled",s.isExpired(t.fecha_fin))}}function Q(o,g){if(1&o&&(e.TgZ(0,"div",7)(1,"div",8)(2,"h2",9),e._uU(3),e.qZA(),e.TgZ(4,"h3",10),e._uU(5),e.qZA()(),e.YNc(6,$,15,14,"div",11),e.qZA()),2&o){const t=g.$implicit;e.xp6(3),e.hij("Curso: ",t.curso_name,""),e.xp6(2),e.hij("Docente: ",t.docente_name,""),e.xp6(1),e.Q6J("ngForOf",t.foros)}}function Y(o,g){if(1&o&&(e.TgZ(0,"div",36)(1,"h4",37),e._uU(2,"Respondiendo a:"),e.qZA(),e._UZ(3,"p",38),e.TgZ(4,"p",39),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("innerHTML",t.selectedRespuesta.respuesta,e.oJD),e.xp6(2),e.AsE("",t.selectedRespuesta.alumno," - ",e.xi3(6,3,t.selectedRespuesta.fecha,"dd/MM/yyyy HH:mm"),"")}}function j(o,g){if(1&o){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submitResponse())}),e.qZA(),e.TgZ(1,"button",41),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelResponse())}),e.qZA()}}const K=function(){return{width:"60vw"}},G=function(){return{"960px":"75vw","640px":"100vw"}},W=function(){return{height:"320px"}};let V=(()=>{class o{constructor(t,s){this.foroService=t,this.helperService=s,this.foros=[],this.selectedForo=null,this.newResponse="",this.selectedRespuesta=null}ngOnInit(){this.domain_id=this.helperService.getDominioId(),this.getForos()}getForos(){this.foroService.getForos(this.domain_id,this.helperService.getAlumnoId(),this.helperService.getDocenteId()).subscribe(t=>{this.foros=t.map(s=>({...s,foros:s.foros.map(i=>({...i,respuestas:i.respuestas.map(c=>({...c,subrespuestas:c.subrespuestas}))}))})),console.log("Foros cargados:",this.foros)},t=>console.error("Error al cargar los foros",t))}selectForo(t,s,i){this.selectedForo=t,this.selectedRespuesta=i||s||null,this.newResponse=""}isExpired(t){return new Date>new Date(t)}cancelResponse(){this.selectedForo=null,this.selectedRespuesta=null,this.newResponse=""}submitResponse(){if(this.selectedForo&&this.newResponse){console.log(this.selectedRespuesta);const t={id_foro:this.selectedForo.id_foro,respuesta:this.newResponse,domain_id:this.helperService.getDominioId(),alumno_id:this.helperService.getAlumnoId(),docente_id:this.helperService.getDocenteId(),id_respuesta:this.selectedRespuesta?this.selectedRespuesta.id:null};this.foroService.sendResponse(t).subscribe(s=>{console.log("Respuesta enviada:",s),this.helperService.showSuccessMessage("Respuesta enviada correctamente"),this.getForos()}),this.newResponse="",this.selectedForo=null}}getDaysRemaining(t){const s=new Date,c=new Date(t).getTime()-s.getTime(),d=Math.ceil(c/864e5);return d<0?"Vencido":d.toString()+" d\xedas"}getDaysRemainingClass(t){const s=new Date,c=new Date(t).getTime()-s.getTime(),d=Math.ceil(c/864e5);return d<0?"days-remaining overdue":d<=7?"days-remaining due-soon":"days-remaining on-time"}static#e=this.\u0275fac=function(s){return new(s||o)(e.Y36(U.f),e.Y36(H.$))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-foro-alumnos"]],decls:7,vars:13,consts:[["pTemplate","header"],["class","mb-8",4,"ngFor","ngForOf"],["header","Dejar una respuesta",3,"visible","modal","breakpoints","visibleChange"],["class","mb-4 p-3 bg-gray-100 rounded",4,"ngIf"],[3,"ngModel","ngModelChange"],["pTemplate","footer"],[1,"text-primary","font-semibold","text-2xl"],[1,"mb-8"],[1,"forum-header","bg-gray-100","p-4","rounded-t-lg"],[1,"text-xl","font-bold"],[1,"text-lg"],["class","forum-detail bg-white p-4 border border-gray-200 mb-4 rounded-b-lg shadow",4,"ngFor","ngForOf"],[1,"forum-detail","bg-white","p-4","border","border-gray-200","mb-4","rounded-b-lg","shadow"],[1,"text-xl","font-semibold","mb-4"],[1,"text-gray-700",3,"innerHTML"],[1,"forum-dates","flex","items-center","mb-4"],[1,"pi","pi-calendar","mr-2","text-blue-500"],[1,"mr-2"],[1,"font-semibold","px-2","py-1","rounded",3,"ngClass"],[1,"space-y-6"],["class","bg-gray-50 p-4 rounded shadow-sm",4,"ngFor","ngForOf"],["pButton","","type","button","label","Nueva respuesta","icon","pi pi-plus",1,"mt-6","p-button-outlined",3,"disabled","click"],[1,"bg-gray-50","p-4","rounded","shadow-sm"],[1,"flex","justify-between","items-center","mb-3",2,"align-items","center","column-gap","1em"],[1,"font-semibold","text-lg"],[1,"text-sm","text-gray-500"],[1,"mb-3","text-gray-700",3,"innerHTML"],["pButton","","type","button","label","Responder","icon","pi pi-reply",1,"p-button-text","p-button-sm",3,"disabled","click"],["class","mt-4 space-y-3 pl-6 border-l-2 border-gray-200",4,"ngIf"],[1,"mt-4","space-y-3","pl-6","border-l-2","border-gray-200"],["class","bg-gray-100 p-3 rounded",4,"ngFor","ngForOf"],[1,"bg-gray-100","p-3","rounded"],[1,"flex","justify-between","items-center","mb-2"],[1,"font-semibold","text-sm"],[1,"text-xs","text-gray-500"],[1,"text-sm","text-gray-600",3,"innerHTML"],[1,"mb-4","p-3","bg-gray-100","rounded"],[1,"font-semibold","mb-2"],[3,"innerHTML"],[1,"text-sm","text-gray-500","mt-2"],["pButton","","type","button","label","Enviar","icon","pi pi-send",1,"p-button-primary",3,"click"],["pButton","","type","button","label","Cancelar","icon","pi pi-times",1,"p-button-secondary","ml-2",3,"click"]],template:function(s,i){1&s&&(e.TgZ(0,"p-panel"),e.YNc(1,L,2,0,"ng-template",0),e.YNc(2,Q,7,3,"div",1),e.qZA(),e.TgZ(3,"p-dialog",2),e.NdJ("visibleChange",function(d){return i.selectedForo=d}),e.YNc(4,Y,7,6,"div",3),e.TgZ(5,"p-editor",4),e.NdJ("ngModelChange",function(d){return i.newResponse=d}),e.qZA(),e.YNc(6,j,2,0,"ng-template",5),e.qZA()),2&s&&(e.xp6(2),e.Q6J("ngForOf",i.foros),e.xp6(1),e.Akn(e.DdM(10,K)),e.Q6J("visible",i.selectedForo)("modal",!0)("breakpoints",e.DdM(11,G)),e.xp6(1),e.Q6J("ngIf",i.selectedRespuesta),e.xp6(1),e.Akn(e.DdM(12,W)),e.Q6J("ngModel",i.newResponse))},dependencies:[w.jx,m.Hq,y.mk,y.sg,y.O5,f.s,p.JJ,p.On,C.ML,F.V,y.uU],styles:["p-panel[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:4px;padding:1rem;background-color:#f5f5f5}p-panel[_ngcontent-%COMP%]   .text-primary[_ngcontent-%COMP%]{color:#007bff}p-panel[_ngcontent-%COMP%]   .ui-panel-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;border-bottom:1px solid #ddd;padding-bottom:.5rem;margin-bottom:1rem}.forum-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:1rem}.forum-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .forum-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.forum-detail[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ddd;border-radius:4px;padding:1rem;margin-bottom:1rem}.forum-dates[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1rem}.forum-dates[_ngcontent-%COMP%]   i.pi-calendar[_ngcontent-%COMP%]{font-size:1.2rem;margin-right:.5rem}.forum-dates[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:1rem}.days-remaining[_ngcontent-%COMP%]{font-weight:700}.days-remaining.due-soon[_ngcontent-%COMP%]{color:#ff5722}.days-remaining.on-time[_ngcontent-%COMP%]{color:#4caf50}.days-remaining.overdue[_ngcontent-%COMP%]{color:#f44336}button[_ngcontent-%COMP%]{background-color:#007bff;border:none;color:#fff;padding:.5rem 1rem;border-radius:4px;cursor:pointer;font-size:1rem;transition:background-color .3s,opacity .3s}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}button.disabled[_ngcontent-%COMP%]{background-color:#6c757d;cursor:not-allowed;opacity:.6}button[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed;opacity:.6}p-dialog[_ngcontent-%COMP%]{max-width:600px;border-radius:8px}.p-editor[_ngcontent-%COMP%]{margin-bottom:1rem}ul[_ngcontent-%COMP%]{list-style-type:none}"]})}return o})(),X=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[r.Bz.forChild([{path:"",component:V}]),r.Bz,f.Q,p.u5,C.Z_,x._8,h.U$,u.Xt,m.hJ,a.JH,p.UX,l.j,v.A,_.KZ,M.T,T.q4,O.kW,Z.q,R.EV,D.n,E.O,P.z,S.D,C.Z_,F.S,J.DL,I.aw]})}return o})()},7649:(A,b,n)=>{n.d(b,{f:()=>x});var r=n(9862),f=n(5516),p=n(8926);let x=(()=>{class h{constructor(m,a,l){this.http=m,this.httpClientFormData=a,this.handler=l,this.baseUrl=`${f.N.API_BASE}`,this.urlparametro=`${f.N.API_BASE}`,this.httpOptions={headers:new r.WM({"Content-Type":"application/json"})},this.httpClientFormData=new r.eN(this.handler)}saveForo(m){return this.http.post(`${this.baseUrl}foros`,m)}getForos(m,a,l){return this.http.get(`${this.baseUrl}foros/${m}/${a}/${l}`)}sendResponse(m){return this.http.post(`${this.baseUrl}foros/message`,m)}static#e=this.\u0275fac=function(a){return new(a||h)(p.LFG(r.eN),p.LFG(r.eN),p.LFG(r.jN))};static#t=this.\u0275prov=p.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},6218:(A,b,n)=>{n.d(b,{A:()=>h,g:()=>x});var r=n(8926),f=n(6814),p=n(6223);let x=(()=>{class u{el;ngModel;control;cd;autoResize;onResize=new r.vpe;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(a,l,v,_){this.el=a,this.ngModel=l,this.control=v,this.cd=_}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewChecked(){this.updateState()}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(a){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(a){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(a||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(l){return new(l||u)(r.Y36(r.SBq),r.Y36(p.On,8),r.Y36(p.a5,8),r.Y36(r.sBO))};static \u0275dir=r.lG2({type:u,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(l,v){1&l&&r.NdJ("input",function(M){return v.onInput(M)}),2&l&&r.ekj("p-filled",v.filled)("p-inputtextarea-resizable",v.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}})}return u})(),h=(()=>{class u{static \u0275fac=function(l){return new(l||u)};static \u0275mod=r.oAB({type:u});static \u0275inj=r.cJS({imports:[f.ez]})}return u})()}}]);